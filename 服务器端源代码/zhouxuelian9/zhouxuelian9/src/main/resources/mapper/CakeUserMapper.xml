<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.smxy.zhouxuelian9.mapper.CakeUserMapper">
    <select id="selectAll" resultType="CakeUserInfo">
        select * from cakeuserinfo
    </select>

    <select id="selectOne" parameterType="cn.smxy.zhouxuelian9.entity.CakeUserInfo" resultType="cn.smxy.zhouxuelian9.entity.CakeUserInfo">
        SELECT * FROM cakeuserinfo
        WHERE cakeusername=#{cakeusername} AND password=#{password} AND role=#{role}
    </select>

    <select id="selectById" parameterType="java.lang.Integer" resultType="cn.smxy.zhouxuelian9.entity.CakeUserInfo">
        SELECT * FROM cakeuserinfo WHERE cakeuserId = #{id}
    </select>

    <select id="finduser" parameterType="cn.smxy.zhouxuelian9.entity.CakeUserInfo" resultType="cn.smxy.zhouxuelian9.entity.CakeUserInfo">
        select * from cakeuserinfo
        <where>
            <if test="cakeusername != null and cakeusername != ''">
                cakeusername like concat('%', #{cakeusername}, '%')
            </if>
            <if test="phone != null and phone != ''">
                and phone like concat('%', #{phone}, '%')
            </if>
            <if test="password != null and password != ''">
                and password like concat('%', #{password}, '%')
            </if>
            <if test="role != null and role != ''">
                and role like concat('%', #{role}, '%')
            </if>
        </where>
    </select>

    <insert id="add" parameterType="CakeUserInfo" useGeneratedKeys="true" keyProperty="cakeuserId">
        insert into cakeuserinfo(cakeusername, password, sex, address, phone, cakeuserImage, role)
        values(#{cakeusername}, #{password}, #{sex}, #{address}, #{phone}, #{cakeuserImage}, #{role})
    </insert>

    <update id="update" parameterType="CakeUserInfo">
        update cakeuserinfo set password=#{password} where cakeusername=#{cakeusername} and phone=#{phone}
    </update>

    <delete id="deleteUser" parameterType="Integer">
        delete from cakeuserinfo where cakeuserId = #{cakeuserId}
    </delete>

    <update id="updateUser" parameterType="CakeUserInfo">
        update cakeuserinfo
        set cakeusername=#{cakeusername}, password=#{password}, sex=#{sex}, address=#{address}, phone=#{phone},cakeuserImage=#{cakeuserImage},role=#{role}
        where cakeuserId=#{cakeuserId}
    </update>
</mapper>